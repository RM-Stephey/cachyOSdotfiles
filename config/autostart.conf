# ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
# ┃                    Hyprland Autostart                      ┃
# ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

# Quickshell instances - using exec-once for reliability
# Note: XDG autostart desktop files exist but aren't starting automatically
# Using exec-once ensures they start reliably on boot
# Tray apps must start BEFORE Quickshell for SystemTray.items to detect them

# Start Pyprland daemon for scratchpads
exec-once = pypr

# Wallpaper (must start early)
exec-once = uwsm app -- swaybg -i ~/.config/backgrounds/cyber-city-neon.png -m fill

# Tray applications (must start BEFORE Quickshell for SystemTray.items to detect them)
exec-once = /usr/bin/copyq --start-server
exec-once = env /opt/beeper/beepertexts --ozone-platform=wayland --enable-features=UseOzonePlatform,WaylandWindowDecorations --start-minimized
exec-once = /opt/1Password/1password --silent --use-system-authentication --on-system-unlock
exec-once = /usr/bin/ulauncher --hide-window

# Quickshell instances - using exec-once since XDG autostart isn't working reliably
# Note: Tray apps must start BEFORE Quickshell for SystemTray.items to detect them
exec-once = uwsm app -- qs -c waybar
exec-once = uwsm app -- qs -c overview

# Preload file manager backend services for faster pcmanfm-qt startup
exec-once = gio mount -l 2>/dev/null

# Run pcmanfm-qt in daemon mode for instant file manager access
exec-once = pcmanfm-qt --daemon-mode

# Session restore (disabled by default)
# exec-once = bash -c '[ -f "$HOME/.config/hypr/saved-sessions/auto-logout.json" ] && (sleep 3 && SESSION_FILE="$HOME/.config/hypr/saved-sessions/auto-logout.json" ~/.config/hypr/scripts/restore-session.sh)'

# Note: uwsm finalize is now handled automatically by uwsm session management
# Manual finalization removed to prevent conflicts with uwsm's automatic handling
