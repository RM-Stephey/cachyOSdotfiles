#!/usr/bin/env bash
set -euo pipefail

DIR="${XDG_SCREENSHOTS_DIR:-${XDG_PICTURES_DIR:-$HOME/Pictures}}/Screenshots"
mkdir -p "$DIR"

FILE="$DIR/screenshot_$(date +'%Y-%m-%d_%H-%M-%S').png"

# Capture full output using grim (installed) instead of grimblast
if grim "$FILE"; then
  if command -v wl-copy >/dev/null 2>&1; then
    wl-copy -t image/png < "$FILE"
    notify-send "Screenshot saved" "$FILE
Copied to clipboard"
  else
    notify-send "Screenshot saved" "$FILE"
  fi
else
  notify-send -u critical "Screenshot failed"
  exit 1
fi
